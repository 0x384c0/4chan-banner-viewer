function domContentLoaded(){bindViews(),loadDataToUrlSelector(),loadStateFromCookies(),createImageViews()}function bindViews(){picOnPageInput=document.getElementById("PicOnPage"),imageUrlMaskSelector=document.getElementById("imageUrlMaskSelector"),imageUrlMaskInput=document.getElementById("URLaddress"),currentImageIdInput=document.getElementById("imageID"),imageContainer=document.getElementById("ImageList")}function loadDataToUrlSelector(){for(var e in imageUrlMasks){var t=document.createElement("option");t.value=imageUrlMasks[e],t.innerHTML=e,imageUrlMaskSelector.appendChild(t)}}function createImageViews(){for(;imageContainer.firstChild;)imageContainer.removeChild(imageContainer.firstChild);for(var e="",t=1;t<=picOnPageInput.value;t++)e=e+"<span id             = 'exlink-"+t+"' class          = 'image-link'><a href           = '' id             = 'img_href"+t+"' target         = '_blank' name           = 'expandfunc' onclick        =  \"return click_on_img("+t+')" oncontextmenu  =  "return rclick_on_img('+t+")\"><img src            ='' width          = '120' height         = '120'  id             = 'img"+t+'\' class          = \'img preview\' onload         = "inc_prbar();" onerror        = "inc_prbar();" /></a></span>';document.getElementById("ImageList").innerHTML=e,reloadImages(),reset_prbar()}function reloadImages(){currentImageIdInput.value<0&&(currentImageIdInput.value=0),picOnPageInput.value<2&&(picOnPageInput.value=2);var e=currentImageIdInput.value;e=parseInt(e);for(var t=1;t<=picOnPageInput.value;){var a=getImageUrl(imageUrlMaskInput.value,e),n=document.getElementById("img"+t);n.src=a;var r=document.getElementById("img_href"+t);r.href=a,e+=parseInt(document.getElementById("Step").value),t++}reset_prbar(),saveStateToCookies()}function onSelectUrlMask(){imageUrlMaskInput.value=imageUrlMaskSelector.value,reloadImages(),reset_prbar()}function click_on_img(e){cur_fulscreen_image=e;var t=document.getElementById("img"+e),a=t.naturalWidth,n=t.naturalHeight,r=t.src;return expand("1",r,"",a,n,220,220)}function rclick_on_img(e){var t=parseInt(currentImageIdInput.value)+e*parseInt(document.getElementById("Step").value)-1,a=document.getElementById("user").value+t;return window.open(a,"_blank"),!1}function right_arrow(){currentImageIdInput.value=parseInt(currentImageIdInput.value)+parseInt(document.getElementById("Step").value)*picOnPageInput.value,reloadImages()}function left_arrow(){currentImageIdInput.value=parseInt(currentImageIdInput.value)-parseInt(document.getElementById("Step").value)*picOnPageInput.value,reloadImages()}function key_detect(e){switch(e.keyCode){case 37:0==document.getElementById("fullscreen-container").offsetHeight?left_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"-1)",50);break;case 39:0==document.getElementById("fullscreen-container").offsetHeight?right_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"+1)",50)}}function GalleryDefaultState(){this.URLaddress=imageUrlMasks.Namba;var e=getCookie(self.imageID),t=getCookie(self.Step),a=getCookie(self.PicOnPage);void 0!=e?this.imageID=e:this.imageID=1,void 0!=t?this.Step=t:this.Step=1,void 0!=a?this.PicOnPage=a:this.PicOnPage=40,this.user="http://namba.kg/#!/photo/"}function loadStateFromCookies(){var e=new GalleryDefaultState;imageUrlMaskInput.value=e.URLaddress,currentImageIdInput.value=e.imageID,document.getElementById("Step").value=e.Step,document.getElementById("user").value=e.user,picOnPageInput.value=e.PicOnPage}function saveStateToCookies(){var e="Mon, 01-Jan-3000 00:00:00 GMT",t=currentImageIdInput.value;setCookie(self.imageID,t,e,"/");var a=document.getElementById("Step").value;setCookie(self.Step,a,e,"/");var n=picOnPageInput.value;setCookie(self.PicOnPage,n,e,"/")}function inc_prbar(){loaded_imgs++,document.getElementById("progress_bar").value++}function reset_prbar(){loaded_imgs=0,document.getElementById("progress_bar").value=0,document.getElementById("progress_bar").max=picOnPageInput.value}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function setCookie(e,t,a,n,r,i){document.cookie=e+"=; expires=Fri, 31 Dec 1999 23:59:59 GMT;",document.cookie=e+"="+t+(a?"; expires="+a:"")+(n?"; path="+n:"")+(r?"; domain="+r:"")+(i?"; secure":"")}function getImageUrl(e,t){return e.replace(imageIdPlaceholder,t)}var imageIdPlaceholder="<image_id>";imageUrlMasks={Namba:"http://d2.files.namba.kg/files/"+imageIdPlaceholder,"4chanGif":"http://s.4cdn.org/image/title/"+imageIdPlaceholder+".gif","4chanPng":"http://s.4cdn.org/image/title/"+imageIdPlaceholder+".png"};var picOnPageInput,currentImageIdInput,imageUrlMaskSelector,imageUrlMaskInput,imageContainer,cur_fulscreen_image=1;window.addEventListener("DOMContentLoaded",domContentLoaded);var loaded_imgs=0,URLaddress="cookies.URLaddress",imageID="cookies.imageID",Step="cookies.Step",PicOnPage="cookies.PicOnPage",userUrl="cookies.userUrl";