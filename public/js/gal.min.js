function domContentLoaded(){bindViews(),loadDataToUrlSelector(),loadStateFromCookies(),createImageViews()}function bindViews(){picOnPageInput=document.getElementById("PicOnPage"),imageUrlMaskSelector=document.getElementById("imageUrlMaskSelector"),imageUrlMaskInput=document.getElementById("URLaddress"),currentImageIdInput=document.getElementById("imageID"),imageContainer=document.getElementById("ImageList")}function loadDataToUrlSelector(){for(var e in imageUrlMasks){var a=document.createElement("option");a.value=imageUrlMasks[e],a.innerHTML=e,imageUrlMaskSelector.appendChild(a)}}function createImageViews(){for(;imageContainer.firstChild;)imageContainer.removeChild(imageContainer.firstChild);for(var e="",a=1;a<=picOnPageInput.value;a++)e=e+"<span id             = 'exlink-"+a+"' class          = 'image-link'><a href           = '' id             = 'img_href"+a+"' name           = 'expandfunc' onclick        = 'return click_on_img("+a+")' target         = '_blank' ><img src            = '' id             = 'img"+a+"' name           = 'img_preview' class          = 'img preview' onload         = \"inc_prbar();\" onerror        = \"inc_prbar();\" /></a></span>";document.getElementById("ImageList").innerHTML=e,reloadImages(),reset_prbar()}function reloadImages(){validateInputs();var e=currentImageIdInput.value;e=parseInt(e);for(var a=1;a<=picOnPageInput.value;){var t=getImageUrl(imageUrlMaskInput.value,e),n=document.getElementById("img"+a);n.src=t;var r=document.getElementById("img_href"+a);r.href=t,e+=parseInt(document.getElementById("Step").value),a++}reset_prbar(),saveStateToCookies()}function validateInputs(){currentImageIdInput.value<0&&(currentImageIdInput.value=0),picOnPageInput.value<1&&(picOnPageInput.value=1)}function onSelectUrlMask(){imageUrlMaskInput.value=imageUrlMaskSelector.value,currentImageIdInput.value=0,reloadImages(),reset_prbar()}function click_on_img(e){cur_fulscreen_image=e;var a=document.getElementById("img"+e),t=2*a.naturalWidth,n=2*a.naturalHeight,r=a.src;return expand("1",r,"",t,n,220,220)}function rclick_on_img(e){var a=document.getElementById("img"+e);return window.open(a.src,"_blank"),!1}function right_arrow(){currentImageIdInput.value=parseInt(currentImageIdInput.value)+parseInt(document.getElementById("Step").value)*picOnPageInput.value,reloadImages()}function left_arrow(){currentImageIdInput.value=parseInt(currentImageIdInput.value)-parseInt(document.getElementById("Step").value)*picOnPageInput.value,reloadImages()}function key_detect(e){switch(e.keyCode){case 37:0==document.getElementById("fullscreen-container").offsetHeight?left_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"-1)",50);break;case 39:0==document.getElementById("fullscreen-container").offsetHeight?right_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"+1)",50)}}function GalleryDefaultState(){var e=getCookie(self.imageID),a=getCookie(self.Step),t=getCookie(self.PicOnPage),n=getCookie(self.ImageUrlMask);void 0!=e?this.imageID=e:this.imageID=1,void 0!=a?this.Step=a:this.Step=1,void 0!=t?this.PicOnPage=t:this.PicOnPage=defaultPicsOnPage,void 0!=n?this.ImageUrlMask=n:this.ImageUrlMask=imageUrlMasks["4chanGif"]}function loadStateFromCookies(){var e=new GalleryDefaultState;imageUrlMaskInput.value=e.ImageUrlMask,currentImageIdInput.value=e.imageID,picOnPageInput.value=e.PicOnPage,document.getElementById("Step").value=e.Step;var a=!1;for(var t in imageUrlMasks){var n=imageUrlMasks[t];if(n==String(e.ImageUrlMask)){imageUrlMaskSelector.value=n,a=!0;break}}a||(imageUrlMaskSelector.value=null)}function saveStateToCookies(){var e="Mon, 01-Jan-3000 00:00:00 GMT",a=currentImageIdInput.value;setCookie(self.imageID,a,e,"/");var t=document.getElementById("Step").value;setCookie(self.Step,t,e,"/");var n=picOnPageInput.value;setCookie(self.PicOnPage,n,e,"/");var r=imageUrlMaskInput.value;setCookie(self.ImageUrlMask,r,e,"/")}function inc_prbar(){loaded_imgs++,document.getElementById("progress_bar").value++}function reset_prbar(){loaded_imgs=0,document.getElementById("progress_bar").value=0,document.getElementById("progress_bar").max=picOnPageInput.value}function getCookie(e){var a=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return a?decodeURIComponent(a[1]):void 0}function setCookie(e,a,t,n,r,i){document.cookie=e+"=; expires=Fri, 31 Dec 1999 23:59:59 GMT;",document.cookie=e+"="+a+(t?"; expires="+t:"")+(n?"; path="+n:"")+(r?"; domain="+r:"")+(i?"; secure":"")}function getImageUrl(e,a){return e.replace(imageIdPlaceholder,a)}var defaultPicsOnPage=28;imageIdPlaceholder="<image_id>",imageUrlMasks={"4chanGif":"http://s.4cdn.org/image/title/"+imageIdPlaceholder+".gif","4chanPng":"http://s.4cdn.org/image/title/"+imageIdPlaceholder+".png","4chanJpg":"http://s.4cdn.org/image/title/"+imageIdPlaceholder+".jpg"};var picOnPageInput,currentImageIdInput,imageUrlMaskSelector,imageUrlMaskInput,imageContainer,cur_fulscreen_image=1;window.addEventListener("DOMContentLoaded",domContentLoaded);var loaded_imgs=0,ImageUrlMask="cookies.ImageUrlMask",imageID="cookies.imageID",Step="cookies.Step",PicOnPage="cookies.PicOnPage",userUrl="cookies.userUrl";