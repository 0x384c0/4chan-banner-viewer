function inc_prbar(){loaded_imgs++,document.getElementById("progress_bar").value++}function reset_prbar(){loaded_imgs=0,document.getElementById("progress_bar").value=0,document.getElementById("progress_bar").max=pic_on_page}function Create(){pic_on_page=document.getElementById("PicOnPage").value;var e="";for(i=1;i<=pic_on_page;i++)e=e+"<span id='exlink-"+i+"' class='image-link'><a href=''id = 'img_href"+i+"' target='_blank' name='expandfunc' onclick=\"return click_on_img("+i+')" oncontextmenu="return rclick_on_img('+i+")\"  ><img src='' width = '120' height = '120'  id = 'img"+i+'\' class=\'img preview\' onload = "inc_prbar();" onerror = "inc_prbar();"/></a></span>';document.getElementById("ImageList").innerHTML=e,REdraw(),reset_prbar()}function REdraw(){var e=document.getElementById("imageID").value;e=parseInt(e);for(var t=1;pic_on_page>=t;){var n=document.getElementById("img"+t);n.src=document.getElementById("URLaddress").value+e;var a=document.getElementById("img_href"+t);a.href=document.getElementById("URLaddress").value+e,e+=parseInt(document.getElementById("Step").value),t++}reset_prbar(),saveStateToCookies()}function click_on_img(e){cur_fulscreen_image=e;var t=document.getElementById("img"+e),n=t.naturalWidth,a=t.naturalHeight,o=t.src;return expand("1",o,"",n,a,220,220)}function rclick_on_img(e){var t=parseInt(document.getElementById("imageID").value)+e*parseInt(document.getElementById("Step").value)-1,n=document.getElementById("user").value+t;return window.open(n,"_blank"),!1}function right_arrow(){document.getElementById("imageID").value=parseInt(document.getElementById("imageID").value)+parseInt(document.getElementById("Step").value)*pic_on_page,REdraw()}function left_arrow(){document.getElementById("imageID").value=parseInt(document.getElementById("imageID").value)-parseInt(document.getElementById("Step").value)*pic_on_page,REdraw()}function key_detect(e){switch(e.keyCode){case 37:0==document.getElementById("fullscreen-container").offsetHeight?left_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"-1)",50);break;case 39:0==document.getElementById("fullscreen-container").offsetHeight?right_arrow():setTimeout("click_on_img("+cur_fulscreen_image+"+1)",50)}}function loadStateToWindow(){var e=new GalleryDefaultState;document.getElementById("URLaddress").value=e.URLaddress,document.getElementById("imageID").value=e.imageID,document.getElementById("Step").value=e.Step,document.getElementById("PicOnPage").value=e.PicOnPage,document.getElementById("user").value=e.user,Create()}function GalleryDefaultState(){this.URLaddress="http://d2.files.namba.kg/files/";var e=getCookie(self.imageID),t=getCookie(self.Step);void 0!=e?this.imageID=e:this.imageID=321,void 0!=t?this.Step=t:this.Step=1,this.PicOnPage=60,this.user="http://namba.kg/#!/photo/"}function saveStateToCookies(){var e=document.getElementById("imageID").value;setCookie(self.imageID,e,"Mon, 01-Jan-3000 00:00:00 GMT","/");var t=document.getElementById("Step").value;setCookie(self.Step,t,"Mon, 01-Jan-3000 00:00:00 GMT","/")}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function setCookie(e,t,n,a,o,i){document.cookie=e+"=; expires=Fri, 31 Dec 1999 23:59:59 GMT;",document.cookie=e+"="+t+(n?"; expires="+n:"")+(a?"; path="+a:"")+(o?"; domain="+o:"")+(i?"; secure":"")}var pic_on_page,cur_fulscreen_image=1,loaded_imgs=0;window.addEventListener("DOMContentLoaded",loadStateToWindow);var URLaddress="cookies.URLaddress",imageID="cookies.imageID",Step="cookies.Step",PicOnPage="cookies.PicOnPage",userUrl="cookies.userUrl";